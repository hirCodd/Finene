(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{551:function(t,a,s){"use strict";s.r(a);var e=s(1),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_1-jvm实战篇"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-jvm实战篇"}},[t._v("#")]),t._v(" 1 JVM实战篇")]),t._v(" "),s("h2",{attrs:{id:"_1-1-jvm参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-jvm参数"}},[t._v("#")]),t._v(" 1.1 JVM参数")]),t._v(" "),s("h4",{attrs:{id:"_1-1-1-标准参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-标准参数"}},[t._v("#")]),t._v(" 1.1.1 标准参数")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-version\n-help\n-server\n-cp\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h4",{attrs:{id:"_1-1-2-x参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-x参数"}},[t._v("#")]),t._v(" 1.1.2 -X参数")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-Xint 解释执行\n-Xcomp 第一次使用就编译成本地代码\n-Xmixed 混合模式，JVM自己来决定\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h4",{attrs:{id:"_1-1-3-xx参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-3-xx参数"}},[t._v("#")]),t._v(" 1.1.3 -XX参数")]),t._v(" "),s("blockquote",[s("p",[t._v("使用得最多的参数类型 非标准化参数，相对不稳定，主要用于JVM调优和Debug")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("a.Boolean类型\n格式：-XX:[+-]<name> +或-表示启用或者禁用name属性\n比如：-XX:+UseConcMarkSweepGC 表示启用CMS类型的垃圾回收器\n\t -XX:+UseG1GC 表示启用G1类型的垃圾回收器\n\n** b.非Boolean类型\n格式：-XX<name>=<value>表示name属性的值是value\n比如：-XX:MaxGCPauseMillis=500\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("h4",{attrs:{id:"_1-1-4-其他参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-4-其他参数"}},[t._v("#")]),t._v(" 1.1.4 其他参数")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-Xms1000等价于-XX:InitialHeapSize=1000\n-Xmx1000等价于-XX:MaxHeapSize=1000\n-Xss100等价于-XX:ThreadStackSize=100\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h4",{attrs:{id:"_1-1-5-查看参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-5-查看参数"}},[t._v("#")]),t._v(" 1.1.5 查看参数")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("java -XX:+PrintFlagsFinal -version > flags.txt")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310215001216.png",alt:""}})]),t._v(" "),s("h4",{attrs:{id:"_1-1-6-设置参数的方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-6-设置参数的方式"}},[t._v("#")]),t._v(" 1.1.6 设置参数的方式")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("开发工具中设置比如IDEA，eclipse")])]),t._v(" "),s("li",[s("p",[t._v("运行jar包的时候:java -XX:+UseG1GC xxx.jar")])]),t._v(" "),s("li",[s("p",[t._v("web容器比如tomcat，可以在脚本中的进行设置")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("通过jinfo实时调整某个java进程的参数(参数只有被标记为manageable的flags可以被实时修改)")])])])]),t._v(" "),s("h4",{attrs:{id:"_1-1-7-实践和单位换算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-7-实践和单位换算"}},[t._v("#")]),t._v(" 1.1.7 实践和单位换算")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("1Byte(字节)=8bit(位)\n1KB=1024Byte(字节)\n1MB=1024KB\n1GB=1024MB\n1TB=1024GB\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("(1)设置堆内存大小和参数打印\n\t-Xmx100M -Xms100M -XX:+PrintFlagsFinal\n(2)查询+PrintFlagsFinal的值\n\t:=true\n(3)查询堆内存大小MaxHeapSize\n\t:= 104857600\n(4)换算\n104857600(Byte)/1024=102400(KB)\n102400(KB)/1024=100(MB)\n(5)结论\n\t104857600是字节单位\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("h4",{attrs:{id:"_1-1-8-常用参数含义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-8-常用参数含义"}},[t._v("#")]),t._v(" 1.1.8 常用参数含义")]),t._v(" "),s("p",[t._v("JVM参数说明："),s("a",{attrs:{href:"https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("JVM参数"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[t._v("调优堆栈内存-堆栈大小典型配置参数")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("配置参数")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置最大堆大小。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m")]),t._v("，设置JVM最大可用内存为3550 MB。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xms")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置JVM初始内存。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xms3550m")]),t._v("，设置JVM初始内存为3550 MB。此值建议与"),s("code",[t._v("-Xmx")]),t._v("相同，避免每次垃圾回收完成后JVM重新分配内存。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmn")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置年轻代大小。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmn2g")]),t._v("，设置年轻代大小为2 GB。整个JVM内存大小=年轻代大小+年老代大小+持久代大小。持久代一般固定大小为64 MB，所以增大年轻代后，将会减小年老代大小。此值对系统性能影响较大，Sun官方推荐配置为整个堆的3/8。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xss")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置线程的栈大小。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xss128k")]),t._v("，设置每个线程的栈大小为128 KB。"),s("strong",[t._v("说明")]),t._v(" JDK 5.0版本以后每个线程栈大小为1 MB，JDK 5.0以前版本每个线程栈大小为256 KB。请依据应用的线程所需内存大小进行调整。在相同物理内存下，减小该值可以生成更多的线程。但是操作系统对一个进程内的线程个数有一定的限制，无法无限生成，一般在3000个~5000个。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:NewRatio=n")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置年轻代和年老代的比值。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:NewRatio=4")]),t._v("，设置年轻代（包括Eden和两个Survivor区）与年老代的比值（除去持久代）。如果设置为4，那么年轻代与年老代所占比值为1:4，年轻代占整个堆栈的1/5。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:SurvivorRatio=n")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("年轻代中Eden区与两个Survivor区的比值。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:SurvivorRatio=4")]),t._v("，设置年轻代中Eden区与Survivor区的大小比值。如果设置为4，那么两个Survivor区与一个Eden区的比值为2:4，一个Survivor区占整个年轻代的1/6。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:MaxPermSize=n")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置持久代大小。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:MaxPermSize=16m")]),t._v("，设置持久代大小为16 MB。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:MaxTenuringThreshold=n")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置垃圾最大年龄。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:MaxTenuringThreshold=0")]),t._v("，设置垃圾最大年龄。如果设置为0，那么年轻代对象不经过Survivor区，直接进入年老代。对于年老代比较多的应用，提高了效率。如果将此值设置为较大值，那么年轻代对象会在Survivor区进行多次复制，增加了对象在年轻代的存活时间，增加在年轻代即被回收的概率。")])])])]),t._v(" "),s("ul",[s("li",[t._v("调优回收器GC-吞吐量优先的GC典型配置参数")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("配置参数")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+UseParallelGC")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("选择垃圾收集器为并行收集器。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3800m -Xms3800m -Xmn2g -Xss128k -XX:+UseParallelGC -XX:ParallelGCThreads=20")]),t._v("，"),s("code",[t._v("-XX:+UseParallelGC")]),t._v("此配置仅对年轻代有效，即在示例配置下，年轻代使用并发收集，而年老代仍旧使用串行收集。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:ParallelGCThreads")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("配置并行收集器的线程数，即同时多少个线程一起进行垃圾回收。"),s("strong",[t._v("说明")]),t._v(" 此值建议配置与处理器数目相等。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3800m -Xms3800m -Xmn2g -Xss128k -XX:+UseParallelGC -XX:ParallelGCThreads=20")]),t._v("，"),s("code",[t._v("-XX:ParallelGCThreads=20")]),t._v("表示配置并行收集器的线程数为20个。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+UseParallelOldGC")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("配置年老代垃圾收集方式为并行收集。"),s("strong",[t._v("说明")]),t._v(" JDK 6.0支持对年老代并行收集。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:+UseParallelGC -XX:ParallelGCThreads=20 -XX:+UseParallelOldGC")]),t._v("，"),s("code",[t._v("-XX:+UseParallelOldGC")]),t._v("表示对年老代进行并行收集。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:MaxGCPauseMillis")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置每次年轻代垃圾回收的最长时间，如果无法满足此时间，JVM会自动调整年轻代大小，以满足此值。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:+UseParallelGC -XX:MaxGCPauseMillis=100")]),t._v("，"),s("code",[t._v("-XX:MaxGCPauseMillis=100")]),t._v("设置每次年轻代垃圾回收的最长时间为100 ms。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+UseAdaptiveSizePolicy")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置此选项后，并行收集器自动选择年轻代区大小和相应的Survivor区比例，以达到目标系统规定的最低响应时该间或者收集频率，该值建议使用并行收集器时，并且一直打开。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:+UseParallelGC -XX:MaxGCPauseMillis=100 -XX:+UseAda")])])])])]),t._v(" "),s("ul",[s("li",[t._v("响应时间优先的GC典型配置参数")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("配置参数")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+UseConcMarkSweepGC")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置年老代为并发收集。"),s("strong",[t._v("说明")]),t._v(" 配置了"),s("code",[t._v("-XX:+UseConcMarkSweepGC")]),t._v("，建议年轻代大小使用"),s("code",[t._v("-Xmn")]),t._v("设置。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:ParallelGCThreads=20 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+UseParNewGC")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("设置年轻代为并行收集。可与CMS收集同时使用。JDK 5.0以上版本，JVM根据系统配置自行设置，无需再设置此值。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:ParallelGCThreads=20 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:CMSFullGCsBeforeCompaction")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("由于并发收集器不对内存空间进行压缩、整理，所以运行一段时间以后会产生“碎片”，使得运行效率降低。此值设置运行多少次GC以后对内存空间进行压缩、整理。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=5 -XX:+UseCMSCompactAtFullCollection")]),t._v("，"),s("code",[t._v("-XX:CMSFullGCsBeforeCompaction=5")]),t._v("，表示运行GC5次后对内存空间进行压缩、整理。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+UseCMSCompactAtFullCollection")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("打开对年老代的压缩。"),s("strong",[t._v("说明")]),t._v(" 该值可能会影响性能，但是可以消除碎片。")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xmx3550m -Xms3550m -Xmn2g -Xss128k -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=5 -XX:+UseCMSCompactAtFullCollection")])])])])]),t._v(" "),s("ul",[s("li",[t._v("用于辅助的GC典型配置参数")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("配置参数")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+PrintGC")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用于输出GC日志。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+PrintGCDetails")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用于输出GC日志。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+PrintGCTimeStamps")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用于输出GC时间戳（JVM启动到当前日期的总时长的时间戳形式）。示例如下："),s("code",[t._v("0.855: [GC (Allocation Failure) [PSYoungGen: 33280K->5118K(38400K)] 33280K->5663K(125952K), 0.0067629 secs] [Times: user=0.01 sys=0.01, real=0.00 secs]")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+PrintGCDateStamps")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用于输出GC时间戳（日期形式）。示例如下："),s("code",[t._v("2022-01-27T16:22:20.885+0800: 0.299: [GC pause (G1 Evacuation Pause) (young), 0.0036685 secs]")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-XX:+PrintHeapAtGC")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("在进行GC前后打印出堆的信息。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("-Xloggc:../logs/gc.log")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("日志文件的输出路径。")])])])]),t._v(" "),s("p",[t._v("全部参数查看：https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html\n"),s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220309162923416.png",alt:"image-20220309162923416"}})]),t._v(" "),s("h2",{attrs:{id:"_1-2-常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-常用命令"}},[t._v("#")]),t._v(" 1.2 常用命令")]),t._v(" "),s("h3",{attrs:{id:"_1-2-1-jps"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-jps"}},[t._v("#")]),t._v(" 1.2.1 jps")]),t._v(" "),s("blockquote",[s("p",[t._v("查看java进程")])]),t._v(" "),s("h3",{attrs:{id:"_1-2-2-jinfo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-jinfo"}},[t._v("#")]),t._v(" 1.2.2 jinfo")]),t._v(" "),s("p",[t._v("(1)实时查看和调整JVM配置参数")]),t._v(" "),s("p",[t._v("(2)查看")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jinfo -flag name PID 查看某个java进程的name属性的值\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("(3)修改")]),t._v(" "),s("blockquote",[s("p",[t._v("参数只有被标记为manageable的flags可以被实时修改")]),t._v(" "),s("p",[t._v("jinfo -flag [+|-] PID")]),t._v(" "),s("p",[t._v("jinfo -flag = PID")])]),t._v(" "),s("p",[t._v("(4)查看曾经赋过值的一些参数")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jinfo -flags PID\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"_1-2-3-jstat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-jstat"}},[t._v("#")]),t._v(" 1.2.3 jstat")]),t._v(" "),s("p",[t._v("(1)查看虚拟机性能统计信息")]),t._v(" "),s("p",[t._v("(2)查看类装载信息")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jstat -class PID 1000 10 查看某个java进程的类装载信息，每1000毫秒输出一次，共输出10次\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310220302064.png",alt:"image-20220310220302064"}})]),t._v(" "),s("p",[t._v("(3)查看垃圾收集信息")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jstat -gc PID 1000 10\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310220241447.png",alt:"image-20220310220241447"}})]),t._v(" "),s("h3",{attrs:{id:"_1-2-4-jstack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4-jstack"}},[t._v("#")]),t._v(" 1.2.4 jstack")]),t._v(" "),s("p",[t._v("(1)查看线程堆栈信息")]),t._v(" "),s("p",[t._v("(2)用法")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jstack PID\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("(3) 排查死锁")]),t._v(" "),s("ul",[s("li",[t._v("DeadLockDemo")])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//运行主类")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLockDemo")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLock")]),t._v(" d1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLock")]),t._v(" d2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" t1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" t2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        t1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        t2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义锁对象")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" obj1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" obj2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//死锁代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLock")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flag"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("obj1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"----if获得obj1锁"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("obj2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"----if获得obj2锁"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("obj2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"----否则获得obj2锁"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("obj1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"----否则获得obj1锁"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br")])]),s("ul",[s("li",[t._v("jstack 分析")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310220950543.png",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310221042830.png",alt:"image-20220310221042830"}})]),t._v(" "),s("h3",{attrs:{id:"_1-2-5-jmap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-5-jmap"}},[t._v("#")]),t._v(" 1.2.5 jmap")]),t._v(" "),s("p",[t._v("(1)生成堆转储快照")]),t._v(" "),s("p",[t._v("(2)打印出堆内存相关信息")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("1.设置：-XX:+PrintFlagsFinal -Xms300M -Xmx300M\n2.查看jmap -heap PID\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310221505262.png",alt:"image-20220310221505262"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310221521362.png",alt:"image-20220310221521362"}})]),t._v(" "),s("p",[t._v("(3)dump出堆内存相关信息、")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jmap -dump:format=b,file=heap.hprof PID\njmap -dump:format=b,file=heap.hprof 44808\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310221914338.png",alt:"image-20220310221914338"}})]),t._v(" "),s("p",[t._v("(4)要是在发生堆内存溢出的时候，能自动dump出该文件就好了")]),t._v(" "),s("blockquote",[s("p",[t._v("一般在开发中，JVM参数可以加上下面两句，这样内存溢出时，会自动dump出该文件")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=heap.hprof\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("设置堆内存大小: -Xms20M -Xmx20M\n启动，然后访问localhost:9090/heap，使得堆内存溢出\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("(5)关于dump下来的文件")]),t._v(" "),s("p",[t._v("一般dump下来的文件可以结合工具来分析")]),t._v(" "),s("h2",{attrs:{id:"_1-3-常用工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-常用工具"}},[t._v("#")]),t._v(" 1.3 常用工具")]),t._v(" "),s("h3",{attrs:{id:"_1-3-1-jconsole"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-jconsole"}},[t._v("#")]),t._v(" 1.3.1 jconsole")]),t._v(" "),s("p",[t._v("JConsole工具是JDK自带的可视化监控工具。查看java应用程序的运行概况、监控堆信息、永久区使用 情况、类加载情况等。")]),t._v(" "),s("blockquote",[s("p",[t._v("启动命令：jconsole")])]),t._v(" "),s("h3",{attrs:{id:"_1-3-2-jvisualvm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-jvisualvm"}},[t._v("#")]),t._v(" 1.3.2 jvisualvm")]),t._v(" "),s("blockquote",[s("p",[t._v("启动命令：jvisualvm")])]),t._v(" "),s("h4",{attrs:{id:"_1-3-2-1-监控本地java进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-1-监控本地java进程"}},[t._v("#")]),t._v(" 1.3.2.1 监控本地Java进程")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310222954259.png",alt:"image-20220310222954259"}})]),t._v(" "),s("h4",{attrs:{id:"_1-3-2-2-监控远端java进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-2-监控远端java进程"}},[t._v("#")]),t._v(" 1.3.2.2 监控远端Java进程")]),t._v(" "),s("blockquote",[s("p",[t._v("比如监控远端tomcat，演示部署在阿里云服务器上的tomcat")])]),t._v(" "),s("p",[t._v("(1)在visualvm中选中“远程”，右击“添加”")]),t._v(" "),s("p",[t._v("(2)主机名上写服务器的ip地址，比如31.100.39.63，然后点击“确定”")]),t._v(" "),s("p",[t._v("(3)右击该主机“31.100.39.63”，添加“JMX”[也就是通过JMX技术具体监控远端服务器哪个Java进程]")]),t._v(" "),s("p",[t._v("(4)要想让服务器上的tomcat被连接，需要改一下 bin/catalina.sh 这个文件")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JAVA_OPTS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_OPTS")]),t._v(' -Dcom.sun.management.jmxremote -\nDjava.rmi.server.hostname=31.100.39.63 -Dcom.sun.management.jmxremote.port=8998\n-Dcom.sun.management.jmxremote.ssl=false -\nDcom.sun.management.jmxremote.authenticate=true -\nDcom.sun.management.jmxremote.access.file=../conf/jmxremote.access -\nDcom.sun.management.jmxremote.password.file=../conf/jmxremote.password"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("(5)在 ../conf 文件中添加两个文件jmxremote.access和jmxremote.password")]),t._v(" "),s("blockquote",[s("p",[t._v("jmxremote.access 文件")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("guest readonly\nmanager readwrite\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])])]),t._v(" "),s("blockquote",[s("p",[t._v("jmxremote.password 文件")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("guest guest\nmanager manager\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])])]),t._v(" "),s("p",[t._v("授予权限 : chmod 600 * jmxremot *")]),t._v(" "),s("p",[t._v("(6)将连接服务器地址改为公网ip地址")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("hostname -i 查看输出情况\n172.26.225.240 172.17.0.1\nvim /etc/hosts\n172.26.255.240 31.100.39.63\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("(7)设置上述端口对应的阿里云安全策略和防火墙策略")]),t._v(" "),s("p",[t._v("(8)启动tomcat，来到bin目录")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./startup.sh\t\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("(9)查看tomcat启动日志以及端口监听")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" -f "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/logs/catalina.out\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lsof")]),t._v(" -i tcp:8080\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("(10)查看8998监听情况，可以发现多开了几个端口")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("lsof -i:8998 得到PID\nnetstat -antup | grep PID\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("(11)在刚才的JMX中输入8998端口，并且输入用户名和密码则登录成功")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("端口:8998\n用户名:manager\n密码:manager\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"_1-3-3-arthas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-arthas"}},[t._v("#")]),t._v(" 1.3.3 Arthas")]),t._v(" "),s("blockquote",[s("p",[t._v("github ：https://github.com/alibaba/arthas")])]),t._v(" "),s("blockquote",[s("p",[t._v("Arthas 是Alibaba开源的Java诊断工具，采用命令行交互模式，是排查jvm相关问题的利器。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://new-blog-1251602255.cos.ap-shanghai.myqcloud.com/img/image-20220310224532713.png",alt:""}})])]),t._v(" "),s("h4",{attrs:{id:"_1-3-3-1-下载安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-1-下载安装"}},[t._v("#")]),t._v(" 1.3.3.1 下载安装")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("curl -O https://alibaba.github.io/arthas/arthas-boot.jar\njava -jar arthas-boot.jar\n# 然后可以选择一个Java进程\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("Print usage")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("java -jar arthas-boot.jar -h\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h4",{attrs:{id:"_1-3-3-2-常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-2-常用命令"}},[t._v("#")]),t._v(" 1.3.3.2 常用命令")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("version:查看arthas版本号\nhelp:查看命名帮助信息\ncls:清空屏幕\nsession:查看当前会话信息\nquit:退出arthas客户端\n---\ndashboard:当前进程的实时数据面板\nthread:当前JVM的线程堆栈信息\njvm:查看当前JVM的信息\nsysprop:查看JVM的系统属性\n---\nsc:查看JVM已经加载的类信息\ndump:dump已经加载类的byte code到特定目录\njad:反编译指定已加载类的源码\n---\nmonitor:方法执行监控\nwatch:方法执行数据观测\ntrace:方法内部调用路径，并输出方法路径上的每个节点上耗时\nstack:输出当前方法被调用的调用路径\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br")])]),s("h3",{attrs:{id:"_1-3-4-mat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-mat"}},[t._v("#")]),t._v(" 1.3.4 MAT")]),t._v(" "),s("blockquote",[s("p",[t._v("Java堆分析器，用于查找内存泄漏\nHeap Dump，称为堆转储文件，是Java进程在某个时间内的快照\n下载地址 ：https://www.eclipse.org/mat/downloads.php")])]),t._v(" "),s("h4",{attrs:{id:"_1-3-4-1-dump信息包含的内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-1-dump信息包含的内容"}},[t._v("#")]),t._v(" 1.3.4.1 Dump信息包含的内容")]),t._v(" "),s("ul",[s("li",[t._v("All Objects")])]),t._v(" "),s("p",[t._v("Class, fields, primitive values and references")]),t._v(" "),s("ul",[s("li",[t._v("All Classes")])]),t._v(" "),s("p",[t._v("Classloader, name, super class, static fields")]),t._v(" "),s("ul",[s("li",[t._v("Garbage Collection Roots")])]),t._v(" "),s("p",[t._v("Objects defined to be reachable by the JVM")]),t._v(" "),s("ul",[s("li",[t._v("Thread Stacks and Local Variables")])]),t._v(" "),s("p",[t._v("The call-stacks of threads at the moment of the snapshot, and per-frame information about local objects")]),t._v(" "),s("h4",{attrs:{id:"_1-3-4-2-获取dump文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-2-获取dump文件"}},[t._v("#")]),t._v(" 1.3.4.2 获取Dump文件")]),t._v(" "),s("ul",[s("li",[t._v("手动")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jmap -dump:format=b,file=heap.hprof 44808\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("自动")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=heap.hprof\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h4",{attrs:{id:"_1-3-4-3-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-3-使用"}},[t._v("#")]),t._v(" 1.3.4.3 使用")]),t._v(" "),s("ul",[s("li",[t._v("Histogram")])]),t._v(" "),s("blockquote",[s("p",[t._v("Histogram可以列出内存中的对象，对象的个数及其大小")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Class Name:类名称，java类名\nObjects:类的对象的数量，这个对象被创建了多少个\nShallow Heap:一个对象内存的消耗大小，不包含对其他对象的引用\nRetained Heap:是shallow Heap的总和，即该对象被GC之后所能回收到内存的总和\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("右击类名---\x3eList Objects---\x3ewith incoming references---\x3e列出该类的实例\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("右击Java对象名---\x3eMerge Shortest Paths to GC Roots---\x3eexclude all ...---\x3e找到GC Root以及原因\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("Leak Suspects")])]),t._v(" "),s("blockquote",[s("p",[t._v("查找并分析内存泄漏的可能原因")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Reports---\x3eLeak Suspects---\x3eDetails\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("Top Consumers")])]),t._v(" "),s("blockquote",[s("p",[t._v("Top Consumers")])]),t._v(" "),s("h3",{attrs:{id:"_1-3-5-gc日志分析工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-5-gc日志分析工具"}},[t._v("#")]),t._v(" 1.3.5 GC日志分析工具")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps\n-Xloggc:gc.log\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("ul",[s("li",[s("p",[t._v("在线 http://gceasy.io")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("GCViewer")])])])])])}),[],!1,null,null,null);a.default=n.exports}}]);